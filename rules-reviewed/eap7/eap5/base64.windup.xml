“A computer lets you make more mistakes faster than any other invention, with the possible exceptions of handguns and Tequila.” - Mitch Ratcliffe<?xml version="1.0"?>
<ruleset id="base64" xmlns="http://windup.jboss.org/schema/jboss-ruleset" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://windup.jboss.org/schema/jboss-ruleset http://windup.jboss.org/schema/jboss-ruleset/windup-jboss-ruleset.xsd">

    <metadata>
        <description>
            This ruleset provides analysis of the org.jboss.util.Base64 class that might require
            individual attention when migrating to JBoss EAP 7+.
            
        </description>
        <dependencies>
            <addon id="org.jboss.windup.rules,windup-rules-javaee,2.5.0.Final" />
            <addon id="org.jboss.windup.rules,windup-rules-java,2.5.0.Final" />
        </dependencies>
        <sourceTechnology id="java-ee" />
        <sourceTechnology id="eap"/>
        <targetTechnology id="eap" versionRange="[6,)" />
    </metadata>

    <rules>
        <rule id="base64-01000">
            <when>
                <javaclass references="org.jboss.util.Base64" />
            </when>
            <perform>
                <hint title="The class org.jboss.util.Base64 has been moved" effort="1" category-id="mandatory">
                    <message>
                        This application contains the class `org.jboss.util.Base64`.
                        
                        Recommendations:
                        
                        * For JDK 8+,migrate to [java.util.Base64](https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html).
                        * For JDK 7, migrate to another Base 64 library, such as [Apache Commons Codec](https://commons.apache.org/proper/commons-codec/).
                    </message>
                    <link href="https://access.redhat.com/solutions/403703" title="Can application use the JBoss EAP org.jboss.util.Base64 built in class?" />
                    <tag>eap7</tag>
                    <tag>base64</tag>
                </hint>
            </perform>
        </rule>
    </rules>
</ruleset>
